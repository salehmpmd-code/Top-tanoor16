<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ø³Ø§ÛŒØª Ù…Ù†ÙˆÛŒ Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
  <style>
    body { font-family: 'Tahoma', sans-serif; margin:0; padding:0; background:#f8f8f8; color:#333; }
    header { background:#fff; padding:10px 20px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    header h1 { margin:0; font-size:24px; display:inline-block; }
    header a { float:left; text-decoration:none; color:#007BFF; font-weight:bold; }
    .hero { display:flex; overflow-x:auto; gap:10px; padding:10px; }
    .hero img { height:200px; border-radius:8px; flex-shrink:0; }
    .items { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; padding:15px; }
    .item { background:#fff; padding:10px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
    .item img { width:100%; height:120px; object-fit:cover; border-radius:5px; }
    .item h3 { margin:5px 0; font-size:18px; }
    .item p { font-size:14px; color:#666; }
    .item .price { font-weight:bold; color:#222; margin-top:5px; }
  </style>
</head>
<body>
  <header>
    <h1 id="siteTitle">Ù…Ù†ÙˆÛŒ Ù…Ù†</h1>
    <a href="admin.html">Ù…Ø¯ÛŒØ±ÛŒØª</a>
  </header>

  <section class="hero" id="heroImages"></section>
  <section class="items" id="itemList"></section>

  <script>
    async function fetchSettings() {
      const res = await fetch('/api/settings');
      if(res.ok) return res.json();
      return {};
    }

    async function fetchItems() {
      const res = await fetch('/api/items');
      if(res.ok) return res.json();
      return [];
    }

    function renderHero(images) {
      const container = document.getElementById('heroImages');
      container.innerHTML = '';
      images.forEach(url => {
        const img = document.createElement('img');
        img.src = url;
        container.appendChild(img);
      });
    }

    function renderItems(items) {
      const container = document.getElementById('itemList');
      container.innerHTML = '';
      items.forEach(item => {
        const div = document.createElement('div');
        div.className = 'item';
        div.innerHTML = `
          <img src="${item.image}" alt="${item.name}">
          <h3>${item.name}</h3>
          <p>${item.description}</p>
          <div class="price">${item.price} ØªÙˆÙ…Ø§Ù†</div>
        `;
        container.appendChild(div);
      });
    }

    async function init() {
      const settings = await fetchSettings();
      document.getElementById('siteTitle').textContent = settings.siteTitle || 'Ù…Ù†ÙˆÛŒ Ù…Ù†';
      renderHero(settings.heroImages || []);
      const items = await fetchItems();
      renderItems(items);
    }

    init();
  </script>
</body>
</html>       <div class="muted">Û¸ ØµØ¨Ø­ ØªØ§ Û±Û± Ø´Ø¨</div>
            </div>
          </div>
          <div class="info-card">
            <div class="icon">ğŸ“</div>
            <div>
              <div style="font-weight:700">Ø¢Ø¯Ø±Ø³</div>
              <div class="muted">Ø®ÛŒØ§Ø¨Ø§Ù† Ù…Ø«Ø§Ù„ØŒ Ù¾Ù„Ø§Ú© Û±Û²</div>
            </div>
          </div>
          <div class="info-card">
            <div class="icon">ğŸ“</div>
            <div>
              <div style="font-weight:700">ØªÙ…Ø§Ø³</div>
              <div class="muted">Û°Û¹Û±Û²-Û±Û²Û³Û´ÛµÛ¶Û·</div>
            </div>
          </div>
        </div>
      </div>

      <div class="hero-right">
        <div class="hero-slider" id="heroSlider" aria-live="polite">
          <!-- Ø§Ø³Ù„Ø§ÛŒØ¯Ù‡Ø§ Ø¨Ø§ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
          <div class="slider-dots" id="sliderDots" role="tablist" aria-label="Ù†Ù‚Ø§Ø· Ø§Ø³Ù„Ø§ÛŒØ¯Ø±"></div>
        </div>
      </div>
    </section>

    <!-- toolbar -->
    <section class="toolbar" id="menu">
      <div class="filters" role="tablist" aria-label="ÙÛŒÙ„ØªØ± Ø¯Ø³ØªÙ‡â€ŒØ¨Ù†Ø¯ÛŒ">
        <button data-filter="all" class="active">Ù‡Ù…Ù‡</button>
        <button data-filter="dessert">Ø¯Ø³Ø±</button>
        <button data-filter="fastfood">ÙØ³Øªâ€ŒÙÙˆØ¯</button>
        <button data-filter="hot">Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ú¯Ø±Ù…</button>
        <button data-filter="cold">Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ø³Ø±Ø¯</button>
      </div>

      <div class="search" role="search" aria-label="Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…Ù†Ùˆ">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/><circle cx="11" cy="11" r="6" stroke="currentColor" stroke-width="1.6"/></svg>
        <input id="searchInput" placeholder="Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ù…Ù†Ùˆ (ÙØ´Ø§Ø± / Ø¨Ø±Ø§ÛŒ ÙÙˆÚ©ÙˆØ³)" aria-label="Ø¬Ø³ØªØ¬Ùˆ" />
        <div id="resultCount" style="color:var(--muted);font-size:13px">0 Ù…ÙˆØ±Ø¯</div>
      </div>
    </section>

    <!-- Ø¨Ø®Ø´â€ŒÙ‡Ø§ -->
    <section class="sections" id="sectionsContainer" aria-live="polite">
      <!-- Ù‡Ø± Ø¨Ø®Ø´ Ø¨Ø§ Ø¬Ø§ÙˆØ§Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø³Ø§Ø®ØªÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯ -->
    </section>

    <!-- ÙÙˆØªØ± Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª -->
    <section id="info" style="margin-top:28px">
      <div style="display:flex;gap:18px;flex-wrap:wrap;align-items:center">
        <div style="flex:1">
          <h3>Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§</h3>
          <p id="aboutText" style="color:var(--muted)">Ù…ØªÙ† Ø¯Ø±Ø¨Ø§Ø±Ù‡ Ù…Ø§ Ø§Ø² ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆØ¯.</p>
        </div>
        <div style="width:260px">
          <h4>ØªÙ…Ø§Ø³</h4>
          <p style="color:var(--muted)">Û°Û¹Û±Û²-Û±Û²Û³Û´ÛµÛ¶Û·</p>
        </div>
      </div>
    </section>

    <footer>
      Â© Û²Û°Û²Û¶ Ú©Ø§ÙÙ‡ ØªØ§Ù¾ ØªÙ†ÙˆØ± â€” Ù‡Ù…Ù‡ Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸ Ø§Ø³Øª
    </footer>
  </main>

  <!-- Ù…ÙˆØ¯Ø§Ù„ Ø¬Ø²Ø¦ÛŒØ§Øª -->
  <div class="modal-backdrop" id="modalBackdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal" role="document" aria-labelledby="modalTitle">
      <div style="display:flex;align-items:center;gap:12px">
        <h3 id="modalTitle">Ø¹Ù†ÙˆØ§Ù†</h3>
        <button class="btn close" id="modalClose" aria-label="Ø¨Ø³ØªÙ† Ù…ÙˆØ¯Ø§Ù„">Ã—</button>
      </div>
      <div id="modalBody" style="margin-top:12px"></div>
    </div>
  </div>

  <!-- Ø¯Ø±Ø§ÙˆØ± Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
  <aside class="drawer" id="mobileDrawer" aria-hidden="true">
    <button class="btn close" id="drawerClose" aria-label="Ø¨Ø³ØªÙ† Ù…Ù†Ùˆ">Ã—</button>
    <nav style="display:flex;flex-direction:column;gap:8px">
      <a href="#dessert" data-target="dessert">Ø¯Ø³Ø±</a>
      <a href="#fastfood" data-target="fastfood">ÙØ³Øªâ€ŒÙÙˆØ¯</a>
      <a href="#hot" data-target="hot">Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ú¯Ø±Ù…</a>
      <a href="#cold" data-target="cold">Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ø³Ø±Ø¯</a>
      <a href="#info" data-target="info">Ø§Ø·Ù„Ø§Ø¹Ø§Øª</a>
    </nav>
  </aside>

  <!-- Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§ -->
  <button class="to-top" id="toTop" aria-label="Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø¨Ø§Ù„Ø§">â†‘</button>

  <!-- ===========================
       3. SCRIPT
       =========================== -->
  <script>
    /* ============
       ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§ÙˆÙ„ÛŒÙ‡ Ùˆ Ú©Ù…Ú©â€ŒÚ©Ù†Ù†Ø¯Ù‡â€ŒÙ‡Ø§
       ============ */
    const api = {
      items: '/api/items',
      settings: '/api/settings',
      upload: '/api/upload'
    };

    const token = localStorage.getItem('token') || null; // Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Ø¨Ø§ÛŒØ¯ ØªÙˆÚ©Ù† Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø°Ø®ÛŒØ±Ù‡ Ú©Ù†Ø¯

    const qs = (s, el=document) => el.querySelector(s);
    const qsa = (s, el=document) => Array.from(el.querySelectorAll(s));

    /* ============
       Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ùˆ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø§Ø² Ø¨Ú©â€ŒØ§Ù†Ø¯
       ============ */
    let SETTINGS = { heroImages: [], siteTitle: 'Ú©Ø§ÙÙ‡ ØªØ§Ù¾ ØªÙ†ÙˆØ±', aboutText: '' };
    let ITEMS = [];

    async function fetchSettings(){
      try{
        const res = await fetch(api.settings);
        if(!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª ØªÙ†Ø¸ÛŒÙ…Ø§Øª');
        const data = await res.json();
        SETTINGS = Object.assign(SETTINGS, data || {});
        applySettings();
      }catch(err){
        console.warn(err);
      }
    }

    async function fetchItems(){
      try{
        const res = await fetch(api.items);
        if(!res.ok) throw new Error('Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§');
        const data = await res.json();
        ITEMS = Array.isArray(data) ? data : [];
        renderSections();
      }catch(err){
        console.warn(err);
      }
    }

    /* ============
       Ø§Ø¹Ù…Ø§Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø±ÙˆÛŒ ØµÙØ­Ù‡
       ============ */
    function applySettings(){
      document.getElementById('heroTitle').textContent = SETTINGS.siteTitle || 'Ú©Ø§ÙÙ‡ ØªØ§Ù¾ ØªÙ†ÙˆØ±';
      document.getElementById('heroSubtitle').textContent = SETTINGS.subtitle || 'Ù‚Ù‡ÙˆÙ‡ ØªØ®ØµØµÛŒ Ùˆ ØªØ¬Ø±Ø¨Ù‡â€ŒØ§ÛŒ Ú©Ù‡ Ù…ÛŒâ€ŒÙ…Ø§Ù†Ø¯';
      document.getElementById('aboutText').textContent = SETTINGS.aboutText || '';
      buildHeroSlider(SETTINGS.heroImages || []);
    }

    /* ============
       Ø§Ø³Ù„Ø§ÛŒØ¯Ø± Ù‡ÛŒØ±Ùˆ
       ============ */
    let sliderIndex = 0;
    let sliderTimer = null;
    function buildHeroSlider(images){
      const slider = qs('#heroSlider');
      slider.innerHTML = '';
      const dots = qs('#sliderDots');
      dots.innerHTML = '';

      if(!images || images.length === 0){
        // ØªØµÙˆÛŒØ± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ SVG ØªØ²Ø¦ÛŒÙ†ÛŒ
        const slide = document.createElement('div');
        slide.className = 'hero-slide active';
        slide.style.background = 'linear-gradient(135deg,#0b1220,#0f1728)';
        slide.innerHTML = '<svg width="220" height="220" viewBox="0 0 200 200" aria-hidden="true"><defs><linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="#ff6b35"/><stop offset="1" stop-color="#ffd166"/></linearGradient></defs><rect x="10" y="10" width="180" height="180" rx="20" fill="url(#g)"/></svg>';
        slider.appendChild(slide);
        return;
      }

      images.forEach((src, i) => {
        const s = document.createElement('div');
        s.className = 'hero-slide' + (i===0 ? ' active' : '');
        s.style.backgroundImage = `url("${src}")`;
        s.setAttribute('role','img');
        s.setAttribute('aria-label', `ØªØµÙˆÛŒØ± Ù‡Ø¯Ø± ${i+1}`);
        slider.appendChild(s);

        const dot = document.createElement('button');
        dot.className = 'dot' + (i===0 ? ' active' : '');
        dot.setAttribute('aria-label', `Ø§Ø³Ù„Ø§ÛŒØ¯ ${i+1}`);
        dot.addEventListener('click', ()=>{ goToSlide(i); });
        dots.appendChild(dot);
      });

      sliderIndex = 0;
      if(sliderTimer) clearInterval(sliderTimer);
      sliderTimer = setInterval(()=>{ nextSlide(); }, 5000);
    }

    function goToSlide(i){
      const slides = qsa('.hero-slide');
      const dots = qsa('.dot');
      slides.forEach(s=>s.classList.remove('active'));
      dots.forEach(d=>d.classList.remove('active'));
      slides[i]?.classList.add('active');
      dots[i]?.classList.add('active');
      sliderIndex = i;
    }
    function nextSlide(){
      const slides = qsa('.hero-slide');
      if(slides.length===0) return;
      sliderIndex = (sliderIndex + 1) % slides.length;
      goToSlide(sliderIndex);
    }

    /* ============
       Ø±Ù†Ø¯Ø± Ø¨Ø®Ø´â€ŒÙ‡Ø§ Ùˆ Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§
       ============ */
    const SECTION_MAP = {
      dessert: 'Ø¯Ø³Ø±',
      fastfood: 'ÙØ³Øªâ€ŒÙÙˆØ¯',
      hot: 'Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ú¯Ø±Ù…',
      cold: 'Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ø³Ø±Ø¯'
    };

    function groupItemsBySection(items){
      const groups = { dessert:[], fastfood:[], hot:[], cold:[] };
      items.forEach(it=>{
        const key = it.s?.name || it.section || 'dessert';
        // normalize keys (backend Ù…Ù…Ú©Ù†Ù‡ id ÛŒØ§ Ù†Ø§Ù… Ø¨Ø¯Ù‡)
        const k = key.toString().toLowerCase();
        if(k.includes('fast') || k.includes('ÙØ³Øª')) groups.fastfood.push(it);
        else if(k.includes('hot') || k.includes('Ú¯Ø±Ù…')) groups.hot.push(it);
        else if(k.includes('cold') || k.includes('Ø³Ø±Ø¯')) groups.cold.push(it);
        else groups.dessert.push(it);
      });
      return groups;
    }

    function renderSections(filter='all', query=''){
      const container = qs('#sectionsContainer');
      container.innerHTML = '';
      const groups = groupItemsBySection(ITEMS);

      Object.keys(SECTION_MAP).forEach(key=>{
        const items = groups[key] || [];
        if(filter !== 'all' && filter !== key) return;
        const sectionEl = document.createElement('div');
        sectionEl.className = 'section reveal';
        sectionEl.id = key;
        sectionEl.innerHTML = `<h2>${SECTION_MAP[key]} <small style="color:var(--muted);font-weight:600">(${items.length})</small></h2><div class="cards" role="list"></div>`;
        const cards = sectionEl.querySelector('.cards');

        const filtered = items.filter(it=>{
          const text = (it.title + ' ' + (it.description||'') + ' ' + (it.tags||'')).toLowerCase();
          return text.includes(query.toLowerCase());
        });

        filtered.forEach(it=>{
          const card = document.createElement('article');
          card.className = 'card';
          card.setAttribute('tabindex','0');
          card.setAttribute('role','listitem');
          const thumb = it.image || it.thumb || '';
          const tags = (it.tags || []).map(t=>`<span class="tag">${t}</span>`).join('');
          const price = formatPrice(it.price || 0);
          card.innerHTML = `
            <div class="thumb" style="background-image:url('${thumb}');background-size:cover;background-position:center
